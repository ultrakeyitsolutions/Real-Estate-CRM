@model List<CRM.Models.LeadLogModel>

<div class="logs-section">
    @if (Model == null || !Model.Any())
    {
        <div class="text-center py-5">
            <i class="fa-solid fa-list-check text-body-tertiary" style="font-size: 4rem;"></i>
            <h5 class="mt-3 text-body-tertiary">No Activity Logs</h5>
            <p class="text-body-secondary">Detailed activity logs will appear here.</p>
        </div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="table-light">
                    <tr>
                        <th style="width: 20%;">Date & Time</th>
                        <th style="width: 15%;">Action</th>
                        <th style="width: 40%;">Description</th>
                        <th style="width: 15%;">User</th>
                        <th style="width: 10%;">Status</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var log in Model)
                    {
                        // Determine log type and badge based on log text
                        var logType = "Info";
                        var badgeClass = "badge-phoenix-secondary";
                        
                        if (log.LogText.Contains("created", StringComparison.OrdinalIgnoreCase) || 
                            log.LogText.Contains("added", StringComparison.OrdinalIgnoreCase))
                        {
                            logType = "Create";
                            badgeClass = "badge-phoenix-success";
                        }
                        else if (log.LogText.Contains("updated", StringComparison.OrdinalIgnoreCase) || 
                                 log.LogText.Contains("modified", StringComparison.OrdinalIgnoreCase))
                        {
                            logType = "Update";
                            badgeClass = "badge-phoenix-primary";
                        }
                        else if (log.LogText.Contains("deleted", StringComparison.OrdinalIgnoreCase) || 
                                 log.LogText.Contains("removed", StringComparison.OrdinalIgnoreCase))
                        {
                            logType = "Delete";
                            badgeClass = "badge-phoenix-danger";
                        }
                        else if (log.LogText.Contains("viewed", StringComparison.OrdinalIgnoreCase) || 
                                 log.LogText.Contains("accessed", StringComparison.OrdinalIgnoreCase))
                        {
                            logType = "View";
                            badgeClass = "badge-phoenix-info";
                        }

                        <tr>
                            <td>
                                <small class="text-body-secondary">
                                    @log.LogDate.ToString("MMM dd, yyyy")<br />
                                    @log.LogDate.ToString("hh:mm tt")
                                </small>
                            </td>
                            <td>
                                <span class="badge @badgeClass fs-10">@logType</span>
                            </td>
                            <td>@log.LogText</td>
                            <td>
                                <small class="text-body-secondary">
                                    @if (log.ExecutiveId.HasValue)
                                    {
                                        var executive = (ViewBag.Executives as List<CRM.Models.UserModel>)?.FirstOrDefault(e => e.UserId == log.ExecutiveId.Value);
                                        @(executive?.Username ?? "Unknown")
                                    }
                                    else
                                    {
                                        <text>System</text>
                                    }
                                </small>
                            </td>
                            <td>
                                <i class="fa-solid fa-circle-check text-success"></i>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- Pagination if needed -->
        @if (Model.Count > 20)
        {
            <nav aria-label="Logs pagination" class="mt-3">
                <ul class="pagination pagination-sm justify-content-center">
                    <li class="page-item disabled">
                        <span class="page-link">Previous</span>
                    </li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#">Next</a>
                    </li>
                </ul>
            </nav>
        }
    }
</div>

<style>
    .logs-section {
        animation: fadeIn 0.3s ease-in;
    }

    .table-hover tbody tr:hover {
        background-color: var(--phoenix-body-bg-emphasis);
        cursor: pointer;
    }

    .badge-phoenix-success {
        background-color: rgba(0, 210, 91, 0.15);
        color: #00d25b;
    }

    .badge-phoenix-primary {
        background-color: rgba(13, 110, 253, 0.15);
        color: #0d6efd;
    }

    .badge-phoenix-danger {
        background-color: rgba(220, 53, 69, 0.15);
        color: #dc3545;
    }

    .badge-phoenix-info {
        background-color: rgba(13, 202, 240, 0.15);
        color: #0dcaf0;
    }

    .badge-phoenix-secondary {
        background-color: rgba(108, 117, 125, 0.15);
        color: #6c757d;
    }

    .table thead th {
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.5px;
        border-bottom: 2px solid var(--phoenix-border-color);
    }

    @@keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
