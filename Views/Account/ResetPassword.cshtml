@model CRM.Models.ResetPasswordModel
@{
    ViewData["Title"] = "Reset Password";
    Layout = "_LayoutLogin";
}
<div class="row justify-content-center">
    <div class="col-md-5">
        <h2>Reset Password</h2>

        @if (ViewBag.Message != null)
        {
                <div class="alert alert-danger">@ViewBag.Message</div>
        }

        <form method="post" asp-action="ResetPassword" novalidate id="resetForm">
            <input type="hidden" name="Username" value="@Model.Username" />
             <div class="mb-3"> 
                 <label>Old Password</label> 
                 <input name="oldPassword" id="oldPassword" class="form-control" type="password" required /> 
                 <div class="invalid-feedback">old password not matching.</div> 
             </div> 
            <div class="mb-3">
                <label>New Password</label>
                <input name="NewPassword" id="NewPassword" class="form-control" type="password" pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*\W).{6,}$" required />
                <div class="invalid-feedback">Password rules not satisfied.</div>
            </div>
            <div class="mb-3">
                <label>Confirm Password</label>
                <input name="ConfirmPassword" id="ConfirmPassword" class="form-control" type="password" required />
                <div class="invalid-feedback">Confirm your password.</div>
            </div>
            <button class="btn btn-success">Change Password</button>
        </form>
    </div>
</div>

@section Scripts {
        <script>
            (function () {
                var form = document.getElementById('resetForm');
                form.addEventListener('submit', function (event) {
                    var np = document.getElementById('NewPassword').value;
                    var cp = document.getElementById('ConfirmPassword').value;
                    if (np !== cp) {
                        event.preventDefault();
                        event.stopPropagation();
                        alert('Passwords do not match');
                        return;
                    }
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                        form.classList.add('was-validated');
                    }
                }, false);
            })();
        </script>
}