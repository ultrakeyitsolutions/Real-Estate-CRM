@model CRM.Models.ForgotPasswordModel
@{
    ViewData["Title"] = "Forgot Password";
    Layout = "_LayoutLogin";
}

<div class="login-left">
    <div class="brand-content">
        <div class="brand-logo">
            @if (!string.IsNullOrEmpty(ViewBag.CompanyLogo))
            {
                <img src="@ViewBag.CompanyLogo" alt="@(ViewBag.CompanyName ?? "Company Logo")" />
            }
            else
            {
                <i class="fas fa-key"></i>
            }
        </div>
        <h1>Password Recovery</h1>
        <p>Don't worry! It happens. Enter your email address and we'll send you a link to reset your password.</p>
        <div class="brand-features">
            <i class="fas fa-shield-alt"></i>
            <i class="fas fa-lock"></i>
            <i class="fas fa-envelope"></i>
        </div>
    </div>
</div>

<div class="login-form-section">
    <div class="login-header">
        <h1>Reset Password</h1>
        <p>Enter your email to receive reset instructions</p>
    </div>

    @if (ViewBag.Message != null)
    {
        <div class="alert alert-success" role="alert">
            <i class="fas fa-check-circle"></i>
            <span>@ViewBag.Message</span>
        </div>
    }

    <form method="post" asp-action="ForgotPassword" id="forgotForm">
        <div class="input-wrapper">
            <label for="Email" class="form-label">Email Address</label>
            <i class="fas fa-envelope"></i>
            <input name="Email" id="Email" class="form-control" type="email" placeholder="Enter your email address" required />
            <span class="text-danger" id="emailError"></span>
        </div>

        <button type="submit" class="btn-primary">
            <i class="fas fa-paper-plane"></i>Send Reset Link
        </button>

        <div class="divider">
            <span>REMEMBER YOUR PASSWORD?</span>
        </div>

        <a href="/Account/Login" class="btn-secondary">
            <i class="fas fa-arrow-left"></i>Back to Login
        </a>
    </form>
</div>

@section Scripts {
    <script>
        document.getElementById('forgotForm').addEventListener('submit', function (event) {
            const emailInput = document.getElementById('Email');
            const emailError = document.getElementById('emailError');
            const emailPattern = /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/;

            emailError.textContent = '';

            if (!emailInput.value) {
                event.preventDefault();
                emailError.textContent = 'Email address is required';
                emailInput.focus();
            } else if (!emailPattern.test(emailInput.value)) {
                event.preventDefault();
                emailError.textContent = 'Please enter a valid email address';
                emailInput.focus();
            }
        });
    </script>
}